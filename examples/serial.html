<!doctype html>
<title>Serial example</title>

<!-- xterm.js -->
<link rel="stylesheet" href="../node_modules/xterm/dist/xterm.css" />
<script src="../node_modules/xterm/dist/xterm.js"></script>

<script src="../build/libv86.js"></script>
<script>
"use strict";

window.onload = function()
{
    var emulator = new V86Starter({
        // Uncomment to see what's going on
        screen_container: document.getElementById("screen_container"),

        bios: {
            url: "../bios/seabios.bin",
        },
        vga_bios: {
            url: "../bios/vgabios.bin",
        },
        cdrom: {
            url: "../images/linux.iso",
        },
        autostart: true,
        disable_keyboard: true,
    });

    var term = window.term = new Terminal();
    term.open(document.getElementById('terminal'));
    term.on('key', key => emulator.serial0_send(key));

    emulator.add_listener("serial0-output-char", (char) => term.write(char));
};
</script>

<div id="screen_container">
    <div style="white-space: pre; font: 14px monospace; line-height: 14px"></div>
    <canvas style="display: none"></canvas>
</div>

<!-- for xterm.js -->
<div id="terminal"></div>
